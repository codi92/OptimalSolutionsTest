pipeline {
  agent any
   stages {
                stage('Stoping containers before Biulding') { steps {	sh '''
#!/bin/bash
echo "bmFtZXM9KGZpcnN0X25naW54IHNlY29uZF9uZ2lueCB0aGlyZF9uZ2lueCBmb3VydGhfbmdpbnggZmlmdGhfbmdpbnggc2l4dGhfbmdpbngpCk9VVFBVVD0wCndoaWxlIFsgJE9VVFBVVCAtbGUgNSBdCmRvCmlmIGRvY2tlciBwcyAtYSB8IGdyZXAgJHtuYW1lc1tPVVRQVVRdfSA7IHRoZW4KZWNobyAiU3RvcCBjb250YWluZXIiCmRvY2tlciBzdG9wICR7bmFtZXNbT1VUUFVUXX0KZmkKT1VUUFVUPSQoKE9VVFBVVCsxKSkKZG9uZQo="|base64 -d|bash
'''}}
		stage('Remove images') { steps { sh '''
docker rmi -f codi92/devopbuild_nginx
'''}}
		stage('Start build') { steps { sh '''
docker-compose build
'''}}
	   	stage('Start build') { steps { sh '''
	   echo "IyEvYmluL2Jhc2gKT1VUUFVUPTAKcmVxPSI1Igpwb3J0cz0oODEyMCA4MTIxIDgxMjIgODEyMyA4MTI0IDgxMjUpCm5hbWVzPShmaXJzdF9uZ2lueCBzZWNvbmRfbmdpbnggdGhpcmRfbmdpbnggZm91cnRoX25naW54IGZpZnRoX25naW54IHNpeHRoX25naW54KQpicmluZ2U9YGRvY2tlciBuZXR3b3JrIGxzIHwgZ3JlcCAiYnJpZGdlIiB8IGF3ayAne3ByaW50ICQxfSdgCmVjaG8gInVwc3RyZWFtIGRldm9wcyB7Ij5udG1wCndoaWxlIFsgJE9VVFBVVCAtbGUgJHJlcSBdCmRvCmlmIGRvY2tlciBwcyAtYSB8IGdyZXAgJHtuYW1lc1tPVVRQVVRdfTsgdGhlbgpkb2NrZXIgc3RvcCAke25hbWVzW09VVFBVVF19CmZpCmRvY2tlciBydW4gLWl0IC0tcm0gLWQgLXAgJHtwb3J0c1tPVVRQVVRdfTo4MCAtLWNwdXM9MSAtbSA1MTJtIC0tbWVtb3J5LXJlc2VydmF0aW9uPTI1Nm0gLS1uYW1lICR7bmFtZXNbT1VUUFVUXX0gY29kaTkyL2Rldm9wYnVpbGRfbmdpbngKZWNobyAic2VydmVyIGxvY2FsaG9zdDoke3BvcnRzW09VVFBVVF19IHdlaWdodD0xOyI+Pm50bXAKY29uPSIke25hbWVzW09VVFBVVF19Igpjb250YWluZXJfbmFtZT1gZG9ja2VyIHBzIHxncmVwICR7bmFtZXNbT1VUUFVUXX18YXdrICd7c3lzdGVtKCJlY2hvICIkTkYiICIpfSdgCmNvbnRhaW5lcl9ob3N0bmFtZT1gZG9ja2VyIGV4ZWMgLWkgJGNvbiAgY2F0IC9ldGMvaG9zdG5hbWVgCmNvbnRhaW5lcl9pcD1gZG9ja2VyIG5ldHdvcmsgaW5zcGVjdCAtZiAne3tqc29uIC5Db250YWluZXJzfX0nICR7YnJpbmdlfSB8IGpxICcuW10gfAkJLk5hbWUgKyAiOiIgKyAuSVB2NEFkZHJlc3MnfCB0ciAtZCAnIid8IHRyICc6JyAnICd8YXdrIC12cGFyPSRjb250YWluZXJfbmFtZSAne2ZvcihpPTE7aTw9TkY7aSsrKWlmKCRpPT1wYXIpIHByaW50ICQoaSsxKX0nYAplY2hvICI8aGVhZD48dGl0bGU+SXQgaXMgdGhlIGFwcDwvdGl0bGU+PHN0eWxlPi5jb250ZW50IHttYXgtd2lkdGg6IDUwMHB4O21hcmdpbjogYXV0bztwYWRkaW5nOiAxMHB4O308L3N0eWxlPjwvaGVhZD48Ym9keT48ZGl2IGNsYXNzPSJjb250ZW50Ij48aDE+IEhlbGxvIFdvcmxkIDxicj48aDI+IFRoaXMgaXMgdGhlICRjb250YWluZXJfbmFtZSBjb250YWluZXIgPGJyPjxoMj4gaGlzIGhvc3RuYW1lIGlzIDogJGNvbnRhaW5lcl9ob3N0bmFtZSA8YnI+PGgyPiBoaXMgaXAgaXMgOiAkY29udGFpbmVyX2lwIDxicj48L2Rpdj48L2JvZHk+Ij50bXAKZG9ja2VyIGNwIHRtcCAke25hbWVzW09VVFBVVF19Oi92YXIvd3d3L2FwcC5zbGFqbmV2LnRrL3B1YmxpYy9pbmRleC5odG1sCk9VVFBVVD0kKChPVVRQVVQrMSkpCmRvbmUKZWNobyAifQoiPj5udG1wCnN1ZG8gY3AgLi9udG1wIC9ldGMvbmdpbngvc2l0ZXMtZW5hYmxlZC8Kc3VkbyBzZXJ2aWNlIG5naW54IHJlc3RhcnQKCQkK"| base64 -d |bash
'''}}
	   
}}
